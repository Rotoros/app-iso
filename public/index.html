<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reservas Restaurante</title>
<style>
body { font-family: sans-serif; max-width: 700px; margin: auto; padding: 20px; background: #f4f4f9; }
h1 { color: #333; border-bottom: 2px solid #ff5722; padding-bottom: 10px; }
form { display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px; }
input, select { padding: 8px; border-radius: 4px; border: 1px solid #ccc; }
button { padding: 10px; border: none; border-radius: 4px; background: #ff5722; color: white; cursor: pointer; }
button:hover { opacity: 0.9; }
.reserva { display: flex; justify-content: space-between; padding: 10px; background: white; border-radius: 4px; margin-bottom: 5px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
.actions button { margin-left: 5px; background: #dc3545; }
</style>
</head>
<body>

<h1>ðŸ“… Reservas Restaurante</h1>

<form id="reserva-form">
  <input type="text" id="nombre" placeholder="Nombre" required>
  <input type="date" id="fecha" required>
  <input type="number" id="personas" placeholder="NÃºmero de personas" min="1" required>
  <input type="text" id="mesa" placeholder="Mesa" required>
  <button type="submit">Reservar</button>
</form>

<div id="reservas-list"></div>

<script>
const reservasList = document.getElementById('reservas-list');
const form = document.getElementById('reserva-form');

async function loadReservas() {
  try {
    const res = await fetch('/api/reservas');
    const reservas = await res.json();
    reservasList.innerHTML = '';
    reservas.forEach(r => {
      const div = document.createElement('div');
      div.className = 'reserva';
      div.innerHTML = `<span>${r.nombre} - ${r.fecha} - ${r.personas} personas - Mesa ${r.mesa}</span>`;
      const btn = document.createElement('button');
      btn.textContent = 'Cancelar';
      btn.onclick = () => deleteReserva(r.id);
      div.appendChild(btn);
      reservasList.appendChild(div);
    });
    if(reservas.length===0) reservasList.innerHTML='<p style="text-align:center;color:#666;">No hay reservas</p>';
  } catch(e){console.error(e);}
}

form.addEventListener('submit', async e=>{
  e.preventDefault();
  const nombre = document.getElementById('nombre').value.trim();
  const fecha = document.getElementById('fecha').value;
  const personas = parseInt(document.getElementById('personas').value);
  const mesa = document.getElementById('mesa').value.trim();
  if(!nombre||!fecha||!personas||!mesa) return;

  await fetch('/api/reservas',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({nombre,fecha,personas,mesa})
  });

  form.reset();
  loadReservas();
});

async function deleteReserva(id){
  if(!confirm('Â¿Cancelar esta reserva?')) return;
  await fetch(`/api/reservas/${id}`, {method:'DELETE'});
  loadReservas();
}

window.onload = loadReservas;
</script>
</body>
</html>
